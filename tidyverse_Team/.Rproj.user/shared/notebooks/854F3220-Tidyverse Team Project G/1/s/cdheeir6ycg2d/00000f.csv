"0","# We did not think Tukey's CIs were appropriate. The code for Tukey CIs is included here:"
"0","# math.ses<- aov(hsb2$math~as.factor(hsb2$ses), data=hsb2) "
"0","# summary(math.ses) "
"0"," "
"0","# TukeyHSD(math.ses, conf.level=.95) "
"0",""
"0","# Bootstrapped omnibus code "
"0","low_mean_vector <- NULL "
"0","mid_mean_vector <- NULL"
"0","high_mean_vector <- NULL"
"0","lowSES <- subset(hsb2_data, hsb2_data$ses == 1)"
"0","midSES <- subset(hsb2_data, hsb2_data$ses == 2)"
"0","highSES <- subset(hsb2_data, hsb2_data$ses == 3)"
"0","n1 <- length(lowSES$math) "
"0","n2 <- length(midSES$math)"
"0","n3 <- length(highSES$math)"
"0",""
"0","# Low SES range in means"
"0","for(i in 1:10000) { "
"0","  low_sample <- sample(lowSES$math, n1, replace=TRUE) "
"0","  low_mean_vector <- c(low_mean_vector, mean(low_sample)) "
"0","} "
"0",""
"0","# Mid SES range in means"
"0","for(i in 1:10000) { "
"0","  mid_sample <- sample(midSES$math, n2, replace=TRUE) "
"0","  mid_mean_vector <- c(mid_mean_vector, mean(mid_sample)) "
"0","} "
"0",""
"0","# High SES range in means"
"0","for(i in 1:10000) { "
"0","  high_sample <- sample(highSES$math, n3, replace=TRUE) "
"0","  high_mean_vector <- c(high_mean_vector, mean(high_sample)) "
"0","} "
"0",""
"0","all_means <- data.frame(low_mean_vector, mid_mean_vector, high_mean_vector)"
"0",""
"0","differences <- NULL"
"0",""
"0","for(i in 1:10000) { "
"0","  differences <- c(differences, (max(all_means[i,]) - min(all_means[i,])))"
"0","}"
"0",""
"0","differences <- sort(differences)"
"0","diff_CI <- c(differences[251], differences[9750])"
